<html ng-app="myApp">
<head>
    <link rel="shortcut icon" type="image/x-icon" href="https://www.scriptr.io/themes/scriptr/images/favicon.ico">
    <title>Dashboard Builder</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="//use.fontawesome.com/cb4ba0acea.js"></script>  
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700" rel="stylesheet">
  
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/chart/chart.css">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/searchBox/abn_tree.css">
    <link rel="stylesheet" href="/UIComponents/dashboardBuilder/lib/gridster/angular_gridster.min.css">
    <link rel="stylesheet" href="//cdn.gitcdn.link/cdn/angular/bower-material/v1.1.3/angular-material.css">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/odometer/odometer.car.css">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/thermometer/style.css">
    <link href="//cdnjs.cloudflare.com/ajax/libs/angular-xeditable/0.7.0/css/xeditable.css" rel="stylesheet">
    <link rel="stylesheet" href="/UIComponents/dashboardBuilder/css/dashboard.css">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/ACL/ACL.css">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/gauge/gauge.css">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/grid/grid.css">
    <link href="/UIComponents/dashboard/frontend/components/list/angucomplete.alt.css" rel="stylesheet">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/map/map.css">
    <link href="/UIComponents/dashboard/frontend/components/toggleSwitch/angular_toggle_switch.css" media="all" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/UIComponents/dashboardBuilder/lib/schemaForm/select.min.css">
    <link href="//cdnjs.cloudflare.com/ajax/libs/angular-bootstrap-colorpicker/3.0.31/css/colorpicker.min.css" rel="stylesheet">
    <link href="//cdnjs.cloudflare.com/ajax/libs/angularjs-slider/6.2.2/rzslider.css" media="all" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/UIComponents/dashboard/frontend/components/button/button.css">
    <link href="/UIComponents/dashboard/frontend/components/IFrame/IFrame.css" media="all" rel="stylesheet" type="text/css">
    <link rel="stylesheet"  href="/UIComponents/dashboard/frontend/components/accelerometer/accelerometer.css"/>
    <link href="/UIComponents/dashboardBuilder/lib/schemaForm/spectrum.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/codemirror.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/theme/neo.min.css">
  
    <!-- JQUERY Material  To use jQuery, simply ensure it is loaded before the angular.js file. -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="//code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" ></script>
    <script  src="//cdn.jsdelivr.net/jquery.slick/1.6.0/slick.min.js"></script>
  
    <!-- Libraries -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>	
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.6/handlebars.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/codemirror.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/mode/javascript/javascript.min.js"></script>
    <script src="//maps.google.com/maps/api/js?key=AIzaSyBcPYghFh_BXz4dDz-TXTHbU2iV3Wbf57I&libraries=drawing,visualization"></script>
  
    <!-- Login -->
    <script src="/modules/login/widgets/authorization.js"></script>
  
    <!-- NG material -->
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-route.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-cookies.js"></script>
    <script src="//cdn.rawgit.com/gdi2290/angular-websocket/v1.0.9/angular-websocket.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-slick-carousel/3.1.7/angular-slick.min.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/gridster/angular_gridster.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-animate.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-sanitize.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/angular-underscore.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/angular-translate.min.js"></script>
    <script src='/UIComponents/dashboardBuilder/lib/schemaForm/select.min.js'></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/2.5.0/ui-bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/2.5.0/ui-bootstrap-tpls.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-messages.min.js"></script>      
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular-aria.min.js"></script> 
    <script src="//cdn.gitcdn.link/cdn/angular/bower-material/v1.1.3/angular-material.js"></script> 
    <script src="//s3-us-west-2.amazonaws.com/s.cdpn.io/t-114/svg-assets-cache.js"></script> 
    <script src="/UIComponents/dashboard/frontend/components/map/markerClusterer.js"></script>
  
    <!-- Directives -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.4/raphael-min.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/chart/morris.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/chart/angular.morris.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/gauge/justgauge.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/gauge/angular.gauge.min.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/speedometer/angular.metergauge.min.js"></script>
  	<script src="//d3js.org/d3.v4.min.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/odometer/odometer.min.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/odometer/angular.odometer.min.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/searchBox/abn_tree_directive.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/thermometer/thermometer_directive.js"></script>
    <script src="//rawgit.com/allenhwkim/angularjs-google-maps/master/build/scripts/ng-map.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ag-grid/12.0.0/ag-grid.js?ignore=notused36"></script>
    <script src="/UIComponents/dashboard/frontend/components/list/angucomplete.alt.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/toggleSwitch/angular_toggle_switch.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angularjs-slider/6.2.2/rzslider.min.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/button/angular-promise-buttons.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-xeditable/0.7.0/js/xeditable.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/spectrum.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/angular-spectrum-colorpicker.min.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/tv4.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/objectPath.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/codemirror/js/mode/ui-codemirror.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/schemaForm.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/bootstrapDecorator.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/bootstrap-colorpicker.min.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/bootstrap-ui-select.min.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/bootstrap-ui-codemirror.min.js"></script>
    <script src="/UIComponents/dashboardBuilder/lib/schemaForm/autorefresh.js"></script>
    
    <!-- Components -->
    <script src="/UIComponents/wsProvider.js"></script>
    <script src="/UIComponents/httpProvider.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/chart/chart.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/odometer/odometer.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/speedometer/speedometer.js"></script>
    <script src="/UIComponents/dashboardBuilder/javascript/components/module.js"></script>
    <script src="/UIComponents/dashboardBuilder/javascript/components/library/widgetsConfig.js"></script>
    <script src="/UIComponents/dashboardBuilder/javascript/components/dashboardsList.js"></script>
    <script src="/UIComponents/dashboardBuilder/javascript/components/dashboard.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/searchBox/searchBox.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/gauge/gauge.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/message/displayBox.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/message/message.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/thermometer/thermometer.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/progressBar/progressBar.js"></script> 
    <script src="/UIComponents/dashboard/frontend/components/map/map.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/grid/grid.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/ACL/ACL.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/list/autocomplete.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/toggleSwitch/toggle_switch.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/slider/slider.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/button/button.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/IFrame/IFrame.js"></script>
    <script src="/UIComponents/dashboard/frontend/components/accelerometer/accelerometer.js"></script>
    
    <script src="/UIComponents/layout/frontend/components/module.js"></script>
    <script src="/UIComponents/layout/frontend/components/header/header.js"></script>
    <link rel="stylesheet" href="/UIComponents/layout/frontend/components/header/header.css">
    
    
    <script src="/UIComponents/dashboardBuilder/javascript/config/config.js"></script>
    <script src="/UIComponents/config/scriptrTransport.js"></script>
    
</head> 
  
<script type="text/javascript"> 
    /*
     Handlebars.registerHelper('json', function(context) {
          if(typeof context === "object") {
               console.log("context object", context);
            return JSON.stringify(context);
          } else {
              console.log("context string", context);
            return context;
          }
    }); 
    */
    Handlebars.registerHelper('buildAttr', function(options, block) {
            var accum = '';
            for(option in options){
                var temp = null;
                if(option == 'on-format-data') continue;
                if(typeof options[option] == 'object'){
                    temp = JSON.stringify(options[option]);
                } else {
                    temp = options[option]
                }
                accum += "\t\t\t\t\t\t\t\t\t\t" + option + "=" + "'" + temp +"'\n";
            }

            return accum;
        });
     var myApp= angular.module("myApp", ['DashboardBuilder', 'Layout']);
     $.urlParam = function(name){
    		var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    		if (results==null){
      			return null;
    		}else{
       			return results[1] || 0;
    		}
	}
	angular.module('myApp').config(wssConfig);
    angular.module('myApp').config(httpsConfig);
    angular.module('myApp').run(function(editableOptions, editableThemes) {
        editableThemes.bs3.buttonsClass = 'btn-md';
        editableThemes.bs3.submitTpl = '<button type="submit" class="btn btn-warning" title="Submit" aria-label="Submit"><span class="glyphicon glyphicon-ok"></span></button>';
        editableOptions.theme = 'bs3'; // bootstrap3 theme. Can be also 'bs2', 'default'
     });
  
    
     angular.module('myApp').config(function($routeProvider){
           $routeProvider
            .when("/", {
            	templateUrl: '/UIComponents/dashboardBuilder/view/dashboardsList.html'
          	})
            .when("/dashboardsList", {
            	templateUrl: '/UIComponents/dashboardBuilder/view/dashboardsList.html'
          	})
            .when("/newDashboard",{
               templateUrl: '/UIComponents/dashboardBuilder/view/dashboard.html'
            })
            .when("/scriptrIdeRef/:scriptrIdeRef*", {
            	templateUrl: '/UIComponents/dashboardBuilder/view/dashboard.html'
          	})
          	.when('/scriptName/:scriptName*', {
              	templateUrl: '/UIComponents/dashboardBuilder/view/dashboard.html',
             	controller:  'dashboardCtrl',
              	controllerAs: "vm"
            })
           .when('/logout', {
              	templateUrl: '/UIComponents/dashboardBuilder/view/logout.html'
            }) 
            .otherwise({redirectTo:'/'})
       })
   	  angular.module('myApp').controller('dashboardCtrl', function($scope, httpClient, $sce, $route, $routeParams) {
          var vm = this;
          //vm.user = (atob(document.cookie.split("=")[1]).split(":")[1])
      });
    
    
    if(!$.urlParam('scriptrIdeRef')) { //if not in IDE open login
         var authorization  = $.scriptr.authorization(
        {
          onTokenValid: function(){ }, 
          loginPage: login.loginTarget
        }
      )
    } 
</script>
  
<!--script src="/UIComponents/dashboardBuilder/javascript/dashboard.js"></script-->
<body ng-controller="dashboardCtrl as vm">
   <!--header-top user="vm.user" header-items='{
           "appname": "Dashboard Builder",
           "logout": {"route":"#/logout"}
        }'></header-top-->
  <div>
     <ng-view></ng-view>
 	 <div ng-include="'/UIComponents/dashboardBuilder/view/dashboardTemplate'"></div>
  </div>
</body>  
</html>